# Condensation Pipeline

This document defines the high-level condensation pipeline used by the Abridge project.

The pipeline describes **what happens at each stage**, what goes in, what comes out, and why each stage exists.
It intentionally avoids technical implementation details.

The pipeline is designed to be:
- Deterministic
- Hierarchical
- Faithful to the original narrative
- Scalable to very long novels

---

## 1. Pipeline Overview

The condensation process is performed in multiple stages, each reducing length while preserving plot, causality, and readability.

High-level flow:

Raw Chapters  
→ Condensed Chapters  
→ Condensed Arcs  
→ Final Condensed Novel

Each stage uses the **same condensation rules and editor prompt**.
Only the input scope changes.

---

## 2. Stage 1: Chapter Condensation

### Input
- Individual raw chapters from the original novel
- Chapters are processed independently

### Process
- Each chapter is condensed using the base editor prompt
- Repetition and padding are removed
- All events, actions, decisions, and outcomes are preserved
- Chronology and causality must remain intact

### Output
- One condensed chapter per original chapter
- Output is readable as a standalone narrative unit

### Purpose
- Reduce local redundancy
- Establish a clean narrative baseline
- Preserve full plot fidelity at the chapter level

---

## 3. Stage 2: Arc Condensation

### Input
- Groups of condensed chapters
- Chapters are grouped deterministically

### Arc Grouping Rules
- Arcs consist of a fixed number of chapters (e.g. 10–20)
- If the novel defines volumes, volumes may be used as arcs
- No automatic story-arc detection is required

### Process
- Condensed chapters within an arc are merged
- The merged text is condensed again using the same editor prompt
- Repetition across chapters is removed
- Transitions are smoothed without reinterpreting events

### Output
- One condensed arc per chapter group

### Purpose
- Remove large-scale redundancy
- Improve narrative flow across chapters
- Maintain structural clarity for long novels

---

## 4. Stage 3: Full Novel Condensation

### Input
- All condensed arcs

### Process
- Arcs are merged in chronological order
- The merged text is condensed one final time
- The editor prompt remains unchanged

### Output
- A single continuous condensed novel
- Target length is approximately 10,000–50,000 words
- Output must be readable as an abridged novel

### Purpose
- Produce the final reading artifact
- Allow fast human evaluation of the full story

---

## 5. Prompt Usage

- The same base condensation prompt is used at all stages
- The prompt is versioned and treated as stable
- Changes to the prompt must be deliberate and documented

The pipeline relies on **hierarchical input reduction**, not prompt specialization.

---

## 6. Persistence and File Handling

All intermediate outputs must be preserved.

Recommended structure:

- Raw chapters
- Condensed chapters
- Condensed arcs
- Final condensed novel

Intermediate files must never be silently overwritten.

### Rationale
- Enables debugging and inspection
- Allows regression testing
- Supports prompt iteration and comparison

---

## 7. Quality Expectations

At every stage:
- No plot-relevant events may be lost
- Cause–effect relationships must remain clear
- The narrative must remain chronological
- No opinions, genre labels, or interpretations may appear

If a later stage reveals missing context, earlier stages must be revisited.

---

## 8. Scope Boundaries

This pipeline does **not** include:
- Genre detection
- Character relationship graphs
- Scene detection
- Quality scoring
- UI or presentation layers

Those features, if added, must operate on the output of this pipeline and must not influence condensation.

---

## 9. Editorial Identity

The pipeline enforces a single identity:

Abridge behaves like a disciplined editor working in multiple passes,
cutting excess while preserving the story.
